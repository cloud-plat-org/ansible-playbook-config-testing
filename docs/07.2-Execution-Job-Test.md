


```bash
# AWX Job Execution Test Script
# Usage: source ~/awx-venv/bin/activate && ./docs/07.2-Execution-Job-Test.md

# Activate AWX virtual environment
source ~/awx-venv/bin/activate

# Extract stored OAuth2 token
export AWX_TOKEN=$(kubectl get secret awx-admin-password -n awx -o jsonpath='{.data.password}' | base64 -d)

# AWX Configuration Parameters
export JOB_TEMPLATE_NAME="WSL Service Management"
export PROJECT_NAME="WSL Automation"
export HOST_GROUP="wsl_instances"

# Service Configuration Variables
export SERVICE_NAME="cron"
export SERVICE_STATE="stopped"
export DEBUG_EXTRA=false

# Extra Variables JSON
export EXTRA_VARS="{\"service_name\": \"$SERVICE_NAME\", \"service_state\": \"$SERVICE_STATE\", \"debug_extra\": $DEBUG_EXTRA}"
```

### 1. Launch Job with Extra Variables
```bash
# Launch service lifecycle test
JOB_ID=$(awx --conf.host https://localhost -k --conf.token "$AWX_TOKEN" job_templates launch \
  --job_template "$JOB_TEMPLATE_NAME" \
  --extra_vars "$EXTRA_VARS" | jq -r .id)

echo "Job ID: $JOB_ID"
```

### 2. Monitor Job Execution
```bash
# Check job status
awx --conf.host https://localhost -k --conf.token "$AWX_TOKEN" job get "$JOB_ID" | jq '{id, status, started, finished}'

# Get job output
awx --conf.host https://localhost -k --conf.token "$AWX_TOKEN" job stdout "$JOB_ID"
```

### 3. Launch with Host Limit
```bash
# Launch with specific host limit
JOB_ID=$(awx --conf.host https://localhost -k --conf.token "$AWX_TOKEN" job_templates launch \
  --job_template "$JOB_TEMPLATE_NAME" \
  --limit "$HOST_GROUP" \
  --extra_vars "$EXTRA_VARS" | jq -r .id)

echo "Job ID: $JOB_ID"
```

### 4. Update Project
```bash
# Update the project to pull the latest changes from your repository
PROJECT_ID=$(awx --conf.host https://localhost -k --conf.token "$AWX_TOKEN" projects list --name "$PROJECT_NAME" --format json | jq -r '.results[0].id')
awx --conf.host https://localhost -k --conf.token "$AWX_TOKEN" projects update "$PROJECT_ID" --scm_update_revision
```